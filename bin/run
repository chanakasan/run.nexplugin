#!/bin/bash

main() {
  local main_cmd="run $1 $2 $3"
  local file_1=$1'_'$2'_'$3.sh
  local file_2=$1'_'$2.sh
  local file_3=$1.sh
  local args_1=${@:4}
  local args_2=${@:3}
  local args_3=${@:2}

  exit_if_empty $1
  try_scripts "$PWD/.local/script"
  try_scripts "$HOME/user/script"
  echo " cmd not found: $main_cmd"
}

exit_if_empty() {
  if [ -z "$1" ]; then
    print_usage
    exit 1
  fi
}

try_scripts() {
  local base_path="$1"
  try_script $base_path $file_1 $args_1
  try_script $base_path $file_2 $args_2
  try_script $base_path $file_3 $args_3
}

try_script() {
  local base_path="$1"
  if [ ! -d $base_path ]; then
    return 1
  fi
  local name=$2
  local file=$(find $base_path -type f -name "$name")
  if [ -f "$file" ]; then
    bash $file ${@:3}
    exit $?
  else
    return 1
  fi
}

print_usage() {
  echo " Usage: run <word1> <word2> <word3>"
  echo
}

main $@
