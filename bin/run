#!/bin/bash

main() {
  local main_cmd="run $1 $2 $3"
  local file_1=$1'_'$2'_'$3.sh
  local file_2=$1'_'$2.sh
  local file_3=$1.sh
  local args_1=${@:4}
  local args_2=${@:3}
  local args_3=${@:2}

  if [ -z "$1" ]; then
    print_usage
    exit 1
  fi

  if try_local_script $file_1 $args_1; then
    :
  elif try_local_script $file_2 $args_2; then
    :
  elif try_local_script $file_3 $args_3; then
    :
  elif try_user_script $file_1 $args_1; then
    :
  elif try_user_script $file_2 $args_2; then
    :
  elif try_user_script $file_3 $args_3; then
    :
  else
    echo " command not found: $main_cmd"
  fi
}

try_local_script() {
  local base_path="$PWD/.local/script"
  try_script $1 $base_path ${@:2}
}

try_user_script() {
  local base_path="$HOME/user_script"
  try_script $1 $base_path ${@:2}
}

try_script() {
  local base_path="$2"
  if [ ! -d $base_path ]; then
    return 1
  fi
  local file=$1
  local path_1=$(find $base_path -type f -name "$file")
  if [ -f "$path_1" ]; then
    bash $path_1 ${@:3}
    return 0
  else
    return 1
  fi
}

print_usage() {
  echo " Usage: run <word1> <word2> <word3>"
  echo
}

main $@
